<!-- Modal Backdrop -->
<div
  class="fixed inset-0 bg-slate-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4"
  (click)="onBackdropClick($event)">

  <!-- Modal Content -->
  <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
    <!-- Modal Header -->
    <div class="flex justify-between items-center border-b border-slate-200 px-6 py-4">
      <h2 class="text-2xl font-bold text-slate-900">Registrar Movimiento</h2>
      <button
        (click)="onClose()"
        class="text-slate-400 hover:text-slate-600 transition-colors p-1 rounded-lg hover:bg-slate-100">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="px-6 py-6">
      <!-- Item Info -->
      <div class="bg-slate-50 rounded-lg p-4 mb-6 border border-slate-200">
        <h3 class="font-semibold text-slate-900 mb-2 text-lg">{{ item.nombre }}</h3>
        <div class="flex justify-between text-sm">
          <span class="text-slate-600 font-medium">Stock Actual:</span>
          <span class="font-bold" [class.text-red-600]="item.stock_actual <= item.stock_critico"
                                   [class.text-emerald-600]="item.stock_actual > item.stock_critico">
            {{ item.stock_actual }} unidades
          </span>
        </div>
      </div>

      <!-- Transaction Form -->
      <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()">
        <!-- Transaction Type -->
        <div class="mb-6">
          <label class="block text-slate-900 text-sm font-bold mb-3">
            Tipo de Movimiento
          </label>
          <div class="flex gap-4">
            <label class="flex items-center cursor-pointer group">
              <input
                type="radio"
                formControlName="tipo"
                [value]="TransactionType.ENTRADA"
                class="mr-2 w-4 h-4 text-indigo-600 focus:ring-indigo-500">
              <span class="text-slate-700 group-hover:text-slate-900 font-medium">ENTRADA</span>
            </label>
            <label class="flex items-center cursor-pointer group">
              <input
                type="radio"
                formControlName="tipo"
                [value]="TransactionType.SALIDA"
                class="mr-2 w-4 h-4 text-indigo-600 focus:ring-indigo-500">
              <span class="text-slate-700 group-hover:text-slate-900 font-medium">SALIDA</span>
            </label>
          </div>
        </div>

        <!-- Quantity -->
        <div class="mb-6">
          <label for="cantidad" class="block text-slate-900 text-sm font-bold mb-2">
            Cantidad
          </label>
          <input
            type="number"
            id="cantidad"
            formControlName="cantidad"
            min="1"
            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
            placeholder="Ingrese la cantidad">
          <div *ngIf="transactionForm.get('cantidad')?.invalid && transactionForm.get('cantidad')?.touched"
               class="text-red-600 text-sm mt-2 font-medium">
            âš  La cantidad debe ser al menos 1
          </div>
        </div>

        <!-- Modal Footer -->
        <div class="flex justify-end gap-3 pt-2">
          <button
            type="button"
            (click)="onClose()"
            class="px-5 py-2.5 bg-slate-200 hover:bg-slate-300 text-slate-800 font-semibold rounded-lg transition-all">
            Cancelar
          </button>
          <button
            type="submit"
            [disabled]="transactionForm.invalid"
            class="px-5 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg transition-all shadow-sm hover:shadow-md disabled:bg-slate-300 disabled:text-slate-500 disabled:cursor-not-allowed disabled:shadow-none">
            Confirmar Movimiento
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
